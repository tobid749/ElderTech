@model IEnumerable<Eldertech.Models.ForoMensaje>

@{
    ViewData["Title"] = "Foro";
}
<body>

<header>
  <nav>

    <!-- IZQUIERDA: LOGO + BUSCADOR -->
    <section class="nav-left">
      <a href='@Url.Action("IndexSesionado", "Home")' aria-label="Inicio ElderTech">
        <img src="/Imagenes/Logo.png" alt="Logo ElderTech">
      </a>

      <section class="search-form">
        <form action='@Url.Action("Articulos", "Home")' method="get" role="search">
          <input type="search" name="q" placeholder="Buscar art√≠culos" aria-label="Buscar art√≠culos">
          <button type="submit">üîç</button>
        </form>
      </section>
    </section>


    <!-- DERECHA: BOTONES -->
    <section class="nav-links">
      <ul>
        <li><a href='@Url.Action("Articulos", "Home")'>Art√≠culos</a></li>
        <li><a href='@Url.Action("Camino", "Home")'>Camino</a></li>
        <li><a href='@Url.Action("Aplicaciones", "Home")'>Aplicaciones</a></li>
        <li><a href='@Url.Action("Foro", "Home")'>Foro</a></li>
        <li><a href='@Url.Action("Contacto", "Home")'>Contacto</a></li>
        <li><a href='@Url.Action("NecesitoAyuda", "Home")'>Necesito ayuda</a></li>
      </ul>
    </section>

  </nav>
</header>
<main>
<section class="banner-eldertech">
    <h1><span>Foro</span></h1>
</section>

<section class="foro-publicar mt-5">
    <h4>Escribir un mensaje:</h4>

    <textarea id="mensaje" class="form-control mb-3" rows="4" placeholder="Escribe tu mensaje..."></textarea>

    <button class="btn btn-success" id="btn-publicar">Publicar</button>

    <div id="msg-error" class="alert alert-danger mt-3" style="display:none;">
        ‚ùå Debes iniciar sesi√≥n para publicar un mensaje.
        <br />
        <a href='@Url.Action("IniciarSesion","Home")' class="btn btn-sesion">Iniciar Sesi√≥n</a>
    </div>
</section>

<hr />

<div class="foro-grid">
@foreach (var m in Model)
{
    <div class="foro-card">
        <div class="foro-perfil">
            <img src="@m.Avatar" alt="Avatar @m.NombreUsuario" class="foro-avatar">
            <h4>@m.NombreUsuario</h4>
            <p>@m.Fecha.ToString("dd/MM/yyyy ‚Ä¢ HH:mm")</p>
        </div>
        <p class="foro-texto">@m.Mensaje</p>
    </div>
}
</div>

@if (ViewBag.MostrarMas)
{
    <form method="get" asp-action="Foro">
        <input type="hidden" name="offset" value="@(ViewBag.Offset + 6)" />
        <button class="btn btn-primary mt-4">Ver m√°s</button>
    </form>
}
</main>

</body>
@section Scripts {
<script>
    document.addEventListener("DOMContentLoaded", function () {

        const btn = document.getElementById("btn-publicar");
        const error = document.getElementById("msg-error");

        if (btn) {
            btn.addEventListener("click", function (e) {

                e.preventDefault(); // ‚ùå No env√≠a al servidor

                error.style.display = "block"; // ‚úÖ Muestra el mensaje

                // Animaci√≥n suave
                error.style.opacity = 0;
                setTimeout(() => { error.style.transition = "0.4s"; error.style.opacity = 1; }, 10);

                // Baja scroll
                window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
            });
        }
    });
</script>

}
