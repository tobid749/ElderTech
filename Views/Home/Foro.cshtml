@model IEnumerable<Eldertech.Models.ForoMensaje>

@{
    ViewData["Title"] = "Foro";
}

<header>
  <nav>
    <div class="nav-left">
      <a href='@Url.Action("Index", "Home")' aria-label="Inicio ElderTech" class="brand">
        <img src="/Imagenes/Logo.png" alt="Logo ElderTech" class="logo">
      </a>

      <form action='@Url.Action("Articulos", "Home")' method="get" class="search-form" role="search">
        <input type="search" name="q" placeholder="Buscar art√≠culos" aria-label="Buscar art√≠culos">
        <button type="submit" class="search-btn">üîç</button>
      </form>
    </div>

    <ul class="nav-links">
      <li><a href='@Url.Action("Articulos", "Home")'>Art√≠culos</a></li>
      <li><a href='@Url.Action("Aplicaciones", "Home")'>Aplicaciones</a></li>
      <li><a href='@Url.Action("Foro", "Home")' style="background-color: #008D36;">Foro</a></li>
      <li><a href='@Url.Action("IniciarSesion", "Home")' class="btn-login">Iniciar Sesi√≥n</a></li>
      <li><a href='@Url.Action("Registrarse", "Home")' class="btn-register">Registrarse</a></li>
    </ul>
  </nav>
</header>

<section class="banner-eldertech">
  <h1 class="banner-title"><span class="banner-elder">Foro</span></h1>
</section>

<section class="foro-publicar mt-5">
    <h4>Escribir un mensaje:</h4>

    <textarea id="mensaje" class="form-control mb-3" rows="4" placeholder="Escribe tu mensaje..."></textarea>

    <button class="btn btn-success" id="btn-publicar">Publicar</button>

    <div id="msg-error" class="alert alert-danger mt-3" style="display:none;">
        ‚ùå Debes iniciar sesi√≥n para publicar un mensaje.
        <br />
        <a href='@Url.Action("IniciarSesion","Home")' class="btn btn-sesion">Iniciar Sesi√≥n</a>
    </div>
</section>

<hr />

<div class="foro-grid">
@foreach (var m in Model)
{
    <div class="foro-card">
        <div class="foro-perfil">
            <img src="@m.Avatar" alt="Avatar @m.NombreUsuario" class="foro-avatar">
            <h4>@m.NombreUsuario</h4>
            <p>@m.Fecha.ToString("dd/MM/yyyy ‚Ä¢ HH:mm")</p>
        </div>
        <p class="foro-texto">@m.Mensaje</p>
    </div>
}
</div>

@if (ViewBag.MostrarMas)
{
    <form method="get" asp-action="Foro">
        <input type="hidden" name="offset" value="@(ViewBag.Offset + 6)" />
        <button class="btn btn-primary mt-4">Ver m√°s</button>
    </form>
}

@section Scripts {
<script>
    document.addEventListener("DOMContentLoaded", function () {

        const btn = document.getElementById("btn-publicar");
        const error = document.getElementById("msg-error");

        if (btn) {
            btn.addEventListener("click", function (e) {

                e.preventDefault(); // ‚ùå No env√≠a al servidor

                error.style.display = "block"; // ‚úÖ Muestra el mensaje

                // Animaci√≥n suave
                error.style.opacity = 0;
                setTimeout(() => { error.style.transition = "0.4s"; error.style.opacity = 1; }, 10);

                // Baja scroll
                window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
            });
        }
    });
</script>

}
